<#
.SYNOPSIS
    Performs a full scan using Microsoft Defender and remediates detected malware.

.DESCRIPTION
    This script triggers a full system scan using Microsoft Defender and checks the results for any detected malware.
    If malware is detected, it removes the threats and outputs a message indicating which threats were removed.
    If no malware is detected, it outputs a message stating that no malware was found.

.AUTHOR
    Name        : Allester Padovani
    Title       : Senior IT Specialist
    Script Ver. : 1.0
    Date        : 2025-07-19

.NOTES
    Compatibility: Windows 11 24H2 and above
    Usage        : Suitable for local or remote execution.
    Additional Information:
        - The script uses the `Start-MpScan` cmdlet to initiate a full scan, and the `Get-MpThreatDetection` cmdlet to retrieve scan results.
        - Detected malware is removed using the `Remove-MpThreat` cmdlet.
        - Ensure that you have administrative privileges to run this script.
#>

# Remediation Script: Remediate_Malware.ps1

# Perform a full scan using Microsoft Defender
Start-MpScan -ScanType FullScan

# Check the scan results
$scanResults = Get-MpThreatDetection

if ($scanResults) {
    # Remove detected malware
    Remove-MpThreat -ThreatID $scanResults.ThreatID
    Write-Output "Malware removed: $($scanResults.ThreatName)"
} else {
    Write-Output "No malware detected."
}
